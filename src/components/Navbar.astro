---
import ThemeToggle from './ThemeToggle.astro';

interface Props {
	logo?: string;
	links?: Array<{ label: string; href: string }>;
}

const { logo = 'Portfolio', links = [
	{ label: 'Home', href: '#home' },
	{ label: 'About', href: '#about' },
	{ label: 'Skills', href: '#skills' },
	{ label: 'Projects', href: '#projects' },
	{ label: 'Contact', href: '#contact' },
] } = Astro.props;
---

<nav class="navbar fixed top-0 left-0 right-0 z-[2000] bg-[rgba(250,250,250,0.35)] dark:bg-[rgba(15,23,42,0.35)] backdrop-blur-[20px] border-b transition-all duration-200 hidden lg:block">
	<div class="w-full px-12 py-6 lg:px-8 xl:px-12 flex justify-between items-center">
		<a href="#home" class="nav-logo font-serif text-xl font-normal no-underline transition-colors duration-200 tracking-wide">{logo}</a>
		<div class="flex items-center gap-4">
			<ul class="flex list-none gap-8 m-0 p-0">
				{links.map((link) => (
					<li><a href={link.href} class="nav-link no-underline font-light text-[0.95rem] transition-colors duration-200 relative tracking-wide">{link.label}</a></li>
				))}
			</ul>
			<ThemeToggle />
		</div>
	</div>
</nav>

<!-- Mobile floating menu button -->
<button id="mobile-menu-button" class="fixed bottom-6 right-6 w-14 h-14 rounded-full bg-[rgba(250,250,250,0.2)] dark:bg-[rgba(15,23,42,0.2)] backdrop-blur-[20px] border border-white/10 dark:border-white/5 z-[2000] cursor-pointer flex items-center justify-center transition-all duration-300 shadow-lg dark:shadow-lg/30 hover:bg-[rgba(250,250,250,0.3)] dark:hover:bg-[rgba(15,23,42,0.3)] hover:scale-105 lg:hidden" aria-label="Toggle menu">
	<svg class="menu-icon w-6 h-6 transition-all duration-300 absolute" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
		<line x1="3" y1="6" x2="21" y2="6"></line>
		<line x1="3" y1="12" x2="21" y2="12"></line>
		<line x1="3" y1="18" x2="21" y2="18"></line>
	</svg>
	<svg class="close-icon w-6 h-6 transition-all duration-300 absolute opacity-0 rotate-90" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
		<line x1="18" y1="6" x2="6" y2="18"></line>
		<line x1="6" y1="6" x2="18" y2="18"></line>
	</svg>
</button>

<!-- Mobile expanded menu -->
<div id="mobile-menu" class="fixed bottom-0 left-0 right-0 bg-[rgba(250,250,250,0.2)] dark:bg-[rgba(15,23,42,0.2)] backdrop-blur-[20px] border-t border-white/10 dark:border-white/5 z-[1999] translate-y-full transition-transform duration-300 ease-out max-h-[80vh] overflow-y-auto lg:hidden">
	<div class="px-6 py-8 pb-[calc(1.5rem+56px+1.5rem)]">
		<ul class="flex flex-col gap-6 list-none m-0 p-0">
			{links.map((link) => (
				<li><a href={link.href} class="mobile-nav-link block no-underline font-light text-lg py-3 transition-colors duration-200 relative">{link.label}</a></li>
			))}
		</ul>
		<div class="mt-8 pt-8 border-t border-white/10 dark:border-white/5 flex justify-center">
			<ThemeToggle />
		</div>
	</div>
</div>

<style>
	.navbar {
		border-color: var(--border-color);
	}

	.nav-logo {
		color: var(--text-primary);
	}

	.nav-logo:hover {
		color: var(--accent-primary);
	}

	.nav-link {
		color: var(--text-secondary);
	}

	/* Nav link underline animation */
	.nav-link::after {
		content: '';
		position: absolute;
		bottom: -4px;
		left: 0;
		width: 0;
		height: 1px;
		background: var(--accent-primary);
		transition: width 0.2s ease;
	}

	.nav-link:hover {
		color: var(--accent-primary);
	}

	.nav-link:hover::after {
		width: 100%;
	}

	#mobile-menu-button .menu-icon,
	#mobile-menu-button .close-icon {
		color: var(--text-primary);
	}

	.mobile-nav-link {
		color: var(--text-primary);
	}

	/* Mobile nav link underline animation */
	.mobile-nav-link::after {
		content: '';
		position: absolute;
		bottom: 0;
		left: 0;
		width: 0;
		height: 2px;
		background: var(--accent-primary);
		transition: width 0.2s ease;
	}

	.mobile-nav-link:hover {
		color: var(--accent-primary);
	}

	.mobile-nav-link:hover::after {
		width: 100%;
	}

	/* Mobile menu button active state */
	#mobile-menu-button.active .menu-icon {
		opacity: 0;
		transform: rotate(90deg);
	}

	#mobile-menu-button.active .close-icon {
		opacity: 1;
		transform: rotate(0deg);
	}

	/* Mobile menu active state */
	#mobile-menu.active {
		transform: translateY(0);
	}
</style>

<script>
	// Navbar background on scroll (desktop only)
	window.addEventListener('scroll', () => {
		const navbar = document.querySelector('nav');
		if (!navbar || window.innerWidth <= 1024) return;
		
		const isDark = document.documentElement.classList.contains('dark');
		const currentScroll = window.pageYOffset;

		if (isDark) {
			if (currentScroll > 100) {
				navbar.style.background = 'rgba(15, 23, 42, 0.95)';
			} else {
				navbar.style.background = 'rgba(15, 23, 42, 0.8)';
			}
		} else {
			if (currentScroll > 100) {
				navbar.style.background = 'rgba(250, 250, 250, 0.95)';
			} else {
				navbar.style.background = 'rgba(250, 250, 250, 0.8)';
			}
		}
	});

	// Mobile menu toggle
	document.addEventListener('DOMContentLoaded', () => {
		const menuButton = document.getElementById('mobile-menu-button');
		const mobileMenu = document.getElementById('mobile-menu');
		const mobileLinks = document.querySelectorAll('.mobile-nav-link');

		if (!menuButton || !mobileMenu) return;

		menuButton.addEventListener('click', () => {
			const isActive = menuButton.classList.toggle('active');
			mobileMenu.classList.toggle('active');
			
			// Prevent body scroll when menu is open
			if (isActive) {
				document.body.style.overflow = 'hidden';
			} else {
				document.body.style.overflow = '';
			}
		});

		// Close menu when clicking a link
		mobileLinks.forEach(link => {
			link.addEventListener('click', () => {
				menuButton.classList.remove('active');
				mobileMenu.classList.remove('active');
				document.body.style.overflow = '';
			});
		});

		// Close menu when clicking outside
		mobileMenu.addEventListener('click', (e) => {
			if (e.target === mobileMenu) {
				menuButton.classList.remove('active');
				mobileMenu.classList.remove('active');
				document.body.style.overflow = '';
			}
		});
	});
</script>